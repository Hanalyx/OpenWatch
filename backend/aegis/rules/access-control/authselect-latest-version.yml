id: authselect-latest-version
title: Ensure latest version of authselect is installed
description: >
  The authselect package should be the latest available version from the
  package repository to ensure all security patches are applied.
rationale: >
  Authselect manages PAM and nsswitch.conf configuration. Running the
  latest version ensures known security vulnerabilities are patched
  and proper authentication configuration is possible.
severity: medium
category: access-control
tags: [authselect, pam, authentication, packages, security]

references:
  cis:
    rhel9_v2:  { section: "5.3.1.2", level: "L1", type: "Automated" }
  nist_800_53: ["SI-2", "IA-5"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "rpm -q authselect >/dev/null 2>&1 && echo 'installed'"
      expected_exit: 0
      expected_stdout: "installed"
    remediation:
      mechanism: command_exec
      run: "dnf upgrade -y authselect"
