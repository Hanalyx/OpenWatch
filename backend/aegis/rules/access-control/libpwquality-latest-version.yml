id: libpwquality-latest-version
title: Ensure latest version of libpwquality is installed
description: >
  The libpwquality package should be the latest available version from the
  package repository to ensure all security patches are applied.
rationale: >
  Libpwquality provides password quality checking functionality for PAM.
  Running the latest version ensures proper password policy enforcement
  and security patches are applied.
severity: medium
category: access-control
tags: [libpwquality, pwquality, pam, password, security]

references:
  cis:
    rhel9_v2:  { section: "5.3.1.3", level: "L1", type: "Automated" }
  nist_800_53: ["SI-2", "IA-5"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "rpm -q libpwquality >/dev/null 2>&1 && echo 'installed'"
      expected_exit: 0
      expected_stdout: "installed"
    remediation:
      mechanism: command_exec
      run: "dnf upgrade -y libpwquality"
