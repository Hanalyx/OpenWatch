id: login-defs-umask
title: Set default umask for users
description: >
  The UMASK parameter in /etc/login.defs sets the default file creation mask
  for all users. A umask of 027 or more restrictive ensures new files are not
  readable by other users by default.
rationale: >
  A restrictive umask limits the exposure of newly created files and directories.
  027 ensures owner has full access, group can read/execute, and others have
  no access.
severity: medium
category: access-control
tags: [permissions, user-accounts, login-defs]

references:
  cis:
    rhel8_v4:  { section: "5.6.5", level: "L1", type: "Automated" }
    rhel9_v2:  { section: "5.6.5", level: "L1", type: "Automated" }
  stig:
    rhel9_v2r7:
      vuln_id: "V-258096"
      stig_id: "RHEL-09-412020"
      severity: "CAT II"
  nist_800_53: ["AC-6(1)"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: config_value
      path: "/etc/login.defs"
      key: "UMASK"
      expected: "{{ login_defs_umask }}"
      comparator: ">="
    remediation:
      mechanism: config_set
      path: "/etc/login.defs"
      key: "UMASK"
      value: "{{ login_defs_umask }}"
