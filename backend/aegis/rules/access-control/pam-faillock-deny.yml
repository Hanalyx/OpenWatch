id: pam-faillock-deny
title: Lock accounts after failed login attempts
description: >
  The system must lock an account after a defined number of consecutive failed
  login attempts. This is enforced via the pam_faillock module with a deny
  threshold.
rationale: >
  Without account lockout, an attacker can perform unlimited password guessing
  attacks. A lockout threshold of 3-5 attempts provides a strong defense against
  brute-force attacks while remaining usable for legitimate users who occasionally
  mistype their password.
severity: high
category: access-control
tags: [pam, authentication, account-lockout, brute-force]

references:
  cis:
    rhel8_v4:  { section: "5.4.2.1", level: "L1", type: "Automated" }
    rhel9_v2:  { section: "5.4.2",   level: "L1", type: "Automated" }
    rhel10_v1: { section: "5.3.3.1", level: "L1", type: "Automated" }
  stig:
    rhel8_v2r6:
      vuln_id: "V-230333"
      stig_id: "RHEL-08-020011"
      severity: "CAT II"
      cci: ["CCI-000044"]
    rhel9_v2r7:
      vuln_id: "V-258054"
      stig_id: "RHEL-09-411075"
      severity: "CAT II"
      cci: ["CCI-000044"]
  nist_800_53: ["AC-7(a)"]
  pci_dss_4: ["8.3.4"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - when:
      all: [authselect, pam_faillock]
    check:
      checks:
        - method: config_value
          path: "/etc/security/faillock.conf"
          key: "deny"
          expected: "{{ pam_faillock_deny }}"
          comparator: "<="
        - method: command
          run: "authselect current | grep with-faillock"
          expected_exit: 0
    remediation:
      steps:
        - mechanism: config_set
          path: "/etc/security/faillock.conf"
          key: "deny"
          value: "{{ pam_faillock_deny }}"
          separator: " = "
        - mechanism: command_exec
          run: "authselect enable-feature with-faillock"
          unless: "authselect current | grep -q with-faillock"

  - default: true
    check:
      method: config_value
      path: "/etc/security/faillock.conf"
      key: "deny"
      expected: "{{ pam_faillock_deny }}"
      comparator: "<="
    remediation:
      mechanism: config_set
      path: "/etc/security/faillock.conf"
      key: "deny"
      value: "{{ pam_faillock_deny }}"
      separator: " = "
