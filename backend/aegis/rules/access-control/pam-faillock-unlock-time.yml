id: pam-faillock-unlock-time
title: Set account lockout duration
description: >
  The unlock_time parameter in /etc/security/faillock.conf sets the number
  of seconds before a locked account is automatically unlocked.
rationale: >
  Setting an unlock time ensures accounts are not permanently locked due to
  failed login attempts, while still providing protection against brute-force
  attacks. A value of 900 seconds (15 minutes) is recommended.
severity: medium
category: access-control
tags: [pam, authentication, account-lockout, faillock]

references:
  cis:
    rhel8_v4:  { section: "5.4.2.2", level: "L1", type: "Automated" }
    rhel9_v2:  { section: "5.4.2",   level: "L1", type: "Automated" }
  stig:
    rhel9_v2r7:
      vuln_id: "V-258055"
      stig_id: "RHEL-09-411080"
      severity: "CAT II"
  nist_800_53: ["AC-7(b)"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: config_value
      path: "/etc/security/faillock.conf"
      key: "unlock_time"
      expected: "{{ pam_faillock_unlock_time }}"
      comparator: ">="
    remediation:
      mechanism: config_set
      path: "/etc/security/faillock.conf"
      key: "unlock_time"
      value: "{{ pam_faillock_unlock_time }}"
      separator: " = "
