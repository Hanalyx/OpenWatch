id: pam-latest-version
title: Ensure latest version of pam is installed
description: >
  The pam package should be the latest available version from the
  package repository to ensure all security patches are applied.
rationale: >
  PAM (Pluggable Authentication Modules) is a critical component for
  authentication. Running the latest version ensures known security
  vulnerabilities are patched.
severity: medium
category: access-control
tags: [pam, authentication, packages, security]

references:
  cis:
    rhel9_v2:  { section: "5.3.1.1", level: "L1", type: "Automated" }
  nist_800_53: ["SI-2", "IA-5"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "rpm -q pam >/dev/null 2>&1 && echo 'installed'"
      expected_exit: 0
      expected_stdout: "installed"
    remediation:
      mechanism: command_exec
      run: "dnf upgrade -y pam"
