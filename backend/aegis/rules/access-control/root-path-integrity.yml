id: root-path-integrity
title: Ensure root PATH does not contain current directory
description: >
  The root user's PATH environment variable should not contain the current
  directory (.) or empty path elements (::) which could be exploited to
  execute malicious programs.
rationale: >
  Including the current directory in root's PATH could allow an attacker
  to place a malicious script in a directory and have it executed when
  root runs a common command name from that directory.
severity: high
category: access-control
tags: [root, path, security]

references:
  cis:
    rhel8_v4:  { section: "5.6.7", level: "L1", type: "Automated" }
    rhel9_v2:  { section: "5.6.7", level: "L1", type: "Automated" }
  nist_800_53: ["CM-6"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "echo \"$PATH\" | grep -qE '(^:|:$|::|\\.:|:\\.)' && exit 1 || exit 0"
      expected_exit: 0
    remediation:
      mechanism: manual
      description: >
        Review the PATH environment variable in root's shell profile
        (/root/.bash_profile, /root/.bashrc) and remove any empty elements
        (::), leading colons (:path), trailing colons (path:), or current
        directory references (.:, :.).
