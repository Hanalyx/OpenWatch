id: ssh-access-control
title: Configure SSH access restrictions
description: >
  The SSH daemon must restrict access to authorized users or groups using
  AllowUsers, AllowGroups, DenyUsers, or DenyGroups directives. At least
  one of these directives must be configured to limit which accounts can
  establish SSH sessions.

rationale: >
  Without explicit access restrictions, every account on the system is
  potentially reachable via SSH. An attacker who compromises a service
  account or discovers a weak password on any system account can log in
  remotely. Restricting SSH access to designated users or groups
  implements the principle of least privilege for remote access.

severity: medium
category: access-control
tags: [ssh, access-control, authorization]

references:
  cis:
    rhel10_v1: { section: "5.1.4", level: "L1", type: "Automated" }
    rhel8_v4:  { section: "5.1.6", level: "L1", type: "Automated" }
    rhel9_v2:  { section: "5.1.7", level: "L1", type: "Automated" }
  nist_800_53: ["AC-3", "AC-6"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "grep -rEi '^(AllowUsers|AllowGroups|DenyUsers|DenyGroups)' /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf 2>/dev/null"
      expected_exit: 0
    remediation:
      mechanism: manual
      note: "Configure AllowUsers, AllowGroups, DenyUsers, or DenyGroups with site-specific values"
