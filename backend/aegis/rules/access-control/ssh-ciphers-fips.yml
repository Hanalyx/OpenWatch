id: ssh-ciphers-fips
title: Configure SSH to use FIPS-approved ciphers
description: >
  The SSH daemon must be configured to use only FIPS 140-2 validated
  ciphers for session encryption.
rationale: >
  FIPS-approved ciphers have been validated for cryptographic strength.
  Using only approved ciphers ensures encrypted SSH sessions cannot
  be easily compromised.
severity: high
category: access-control
tags: [ssh, fips, ciphers, cryptography, stig]

references:
  stig:
    rhel9_v2r7:
      vuln_id: "V-257813"
      stig_id: "RHEL-09-255020"
      severity: "CAT II"
  nist_800_53: ["SC-12", "SC-13"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "grep -E '^Ciphers' /etc/ssh/sshd_config | grep -qE 'aes256-ctr|aes192-ctr|aes128-ctr|aes256-gcm|aes128-gcm'"
      expected_exit: 0
    remediation:
      mechanism: config_set
      path: "/etc/ssh/sshd_config"
      key: "Ciphers"
      value: "aes256-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-gcm@openssh.com,aes128-ctr"
      reload: "sshd"
