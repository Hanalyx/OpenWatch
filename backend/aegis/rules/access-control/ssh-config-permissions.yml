id: ssh-config-permissions
title: Set permissions on sshd_config
description: >
  The SSH daemon configuration file must have restrictive permissions to
  prevent unauthorized modification. The sshd_config file controls all
  aspects of SSH daemon behavior including authentication methods,
  access controls, and cryptographic settings.

rationale: >
  An attacker who can modify sshd_config can disable security controls
  such as root login restrictions, enable weak authentication methods, or
  change the log level to suppress audit evidence. Restricting the file
  to mode 0600 owned by root ensures that only the system administrator
  can alter the SSH daemon's security posture.

severity: medium
category: access-control
tags: [ssh, file-permissions, configuration]

references:
  cis:
    rhel10_v1:  { section: "5.1.1", level: "L1", type: "Automated" }
    rhel8_v4:  { section: "5.1.2", level: "L1", type: "Automated" }
    rhel9_v2:  { section: "5.1.1", level: "L1", type: "Automated" }
  stig:
    rhel8_v2r6:
      vuln_id: "V-230291"
      stig_id: "RHEL-08-010530"
      severity: "CAT II"
      cci: ["CCI-000366"]
    rhel9_v2r7:
      vuln_id: "V-257999"
      stig_id: "RHEL-09-255115"
      severity: "CAT II"
      cci: ["CCI-000366"]
  nist_800_53: ["AC-6"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: file_permission
      path: "/etc/ssh/sshd_config"
      owner: "root"
      group: "root"
      mode: "0600"
    remediation:
      mechanism: file_permissions
      path: "/etc/ssh/sshd_config"
      owner: "root"
      group: "root"
      mode: "0600"
