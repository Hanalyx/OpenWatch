id: ssh-gssapi-authentication
title: Disable SSH GSSAPI authentication
description: >
  The SSH daemon must not use GSSAPI authentication unless the environment
  requires Kerberos-based single sign-on. GSSAPI authentication introduces
  additional complexity and exposes the Kerberos credential delegation
  surface through the SSH session.

rationale: >
  Enabling GSSAPI authentication on systems that do not participate in a
  Kerberos realm increases the attack surface without providing security
  benefit. An attacker can exploit GSSAPI negotiation to gather information
  about the authentication infrastructure or attempt credential replay
  attacks against the Kerberos ticket-granting service.

severity: medium
category: access-control
tags: [ssh, authentication, gssapi, kerberos]

references:
  cis:
    rhel10_v1:  { section: "5.1.9", level: "L2", type: "Automated" }
    rhel8_v4:  { section: "5.1.11", level: "L2", type: "Automated" }
    rhel9_v2:  { section: "5.1.11", level: "L2", type: "Automated" }
  stig:
    rhel8_v2r6:
      vuln_id: "V-244528"
      stig_id: "RHEL-08-010522"
      severity: "CAT II"
      cci: ["CCI-000366"]
    rhel9_v2r7:
      vuln_id: "V-258003"
      stig_id: "RHEL-09-255135"
      severity: "CAT II"
      cci: ["CCI-001813"]
  nist_800_53: ["CM-6", "IA-2"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - when: sshd_config_d
    check:
      method: config_value
      path: "/etc/ssh/sshd_config.d"
      key: "GSSAPIAuthentication"
      expected: "no"
      scan_pattern: "*.conf"
    remediation:
      mechanism: config_set_dropin
      dir: "/etc/ssh/sshd_config.d"
      file: "00-aegis-gssapi-authentication.conf"
      key: "GSSAPIAuthentication"
      value: "no"
      reload: "sshd"

  - default: true
    check:
      method: config_value
      path: "/etc/ssh/sshd_config"
      key: "GSSAPIAuthentication"
      expected: "no"
    remediation:
      mechanism: config_set
      path: "/etc/ssh/sshd_config"
      key: "GSSAPIAuthentication"
      value: "no"
      separator: " "
      reload: "sshd"
