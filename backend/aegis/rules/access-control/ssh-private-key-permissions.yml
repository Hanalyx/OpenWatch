id: ssh-private-key-permissions
title: Set permissions on SSH private host keys
description: >
  SSH private host key files must have restrictive permissions to prevent
  unauthorized read access. The private keys under /etc/ssh/ are used to
  prove the server's identity to connecting clients and must be protected
  from disclosure.

rationale: >
  If an attacker can read a server's SSH private host key, they can
  impersonate the server in man-in-the-middle attacks, intercepting all
  traffic between clients and the legitimate server. Restricting file
  permissions to owner root with group ssh_keys ensures only the SSH
  daemon's privilege separation process can access the keys.

severity: medium
category: access-control
tags: [ssh, file-permissions, host-keys]

references:
  cis:
    rhel10_v1:  { section: "5.1.2", level: "L1", type: "Automated" }
    rhel8_v4:  { section: "5.1.4", level: "L1", type: "Automated" }
    rhel9_v2:  { section: "5.1.2", level: "L1", type: "Automated" }
  stig:
    rhel8_v2r6:
      vuln_id: "V-230287"
      stig_id: "RHEL-08-010490"
      severity: "CAT II"
      cci: ["CCI-000366"]
    rhel9_v2r7:
      vuln_id: "V-258000"
      stig_id: "RHEL-09-255120"
      severity: "CAT II"
      cci: ["CCI-000366"]
  nist_800_53: ["AC-6"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: file_permission
      path: "/etc/ssh/ssh_host_*_key"
      owner: "root"
      group: "ssh_keys"
      mode: "0640"
      glob: "ssh_host_*_key"
    remediation:
      mechanism: file_permissions
      path: "/etc/ssh/ssh_host_*_key"
      owner: "root"
      group: "ssh_keys"
      mode: "0640"
      glob: "ssh_host_*_key"
