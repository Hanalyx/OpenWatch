id: ssh-public-key-permissions
title: Set permissions on SSH public host keys
description: >
  SSH public host key files must have appropriate permissions to prevent
  unauthorized modification. The public keys under /etc/ssh/ are used by
  clients to verify the server's identity and must not be writable by
  unprivileged users.

rationale: >
  If an attacker can modify a server's SSH public host key files, they can
  replace them with keys whose corresponding private keys they control.
  Clients that trust the modified public key would then accept connections
  to an attacker-controlled server, enabling man-in-the-middle interception
  of credentials and session data.

severity: medium
category: access-control
tags: [ssh, file-permissions, host-keys]

references:
  cis:
    rhel10_v1:  { section: "5.1.3", level: "L1", type: "Automated" }
    rhel8_v4:  { section: "5.1.5", level: "L1", type: "Automated" }
    rhel9_v2:  { section: "5.1.3", level: "L1", type: "Automated" }
  stig:
    rhel8_v2r6:
      vuln_id: "V-230286"
      stig_id: "RHEL-08-010480"
      severity: "CAT II"
      cci: ["CCI-000366"]
    rhel9_v2r7:
      vuln_id: "V-258001"
      stig_id: "RHEL-09-255125"
      severity: "CAT II"
      cci: ["CCI-000366"]
  nist_800_53: ["AC-6"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: file_permission
      path: "/etc/ssh/ssh_host_*_key.pub"
      owner: "root"
      group: "root"
      mode: "0644"
      glob: "ssh_host_*_key.pub"
    remediation:
      mechanism: file_permissions
      path: "/etc/ssh/ssh_host_*_key.pub"
      owner: "root"
      group: "root"
      mode: "0644"
      glob: "ssh_host_*_key.pub"
