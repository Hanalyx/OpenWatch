id: ssh-rekey-limit
title: Set SSH rekey limit
description: >
  The SSH daemon must force renegotiation of session encryption keys after
  a defined amount of data or time. RekeyLimit ensures that session keys
  are refreshed periodically, limiting the amount of data encrypted under
  any single key.

rationale: >
  Long-lived session keys increase the volume of traffic available for
  cryptanalysis. If an attacker captures encrypted SSH traffic, a rekey
  limit of 1 gigabyte and 1 hour ensures that the practical window for
  any key-recovery attack is bounded, protecting the confidentiality of
  data transmitted over long-running sessions.

severity: medium
category: access-control
tags: [ssh, cryptography, rekey]

references:
  stig:
    rhel8_v2r6:
      vuln_id: "V-230527"
      stig_id: "RHEL-08-040161"
      severity: "CAT II"
      cci: ["CCI-000068"]
    rhel9_v2r7:
      vuln_id: "V-257994"
      stig_id: "RHEL-09-255090"
      severity: "CAT II"
      cci: ["CCI-000068", "CCI-002418", "CCI-002421"]
  nist_800_53: ["SC-13", "AC-17(2)"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - when: sshd_config_d
    check:
      method: config_value
      path: "/etc/ssh/sshd_config.d"
      key: "RekeyLimit"
      expected: "1G 1h"
      scan_pattern: "*.conf"
    remediation:
      mechanism: config_set_dropin
      dir: "/etc/ssh/sshd_config.d"
      file: "00-aegis-rekey-limit.conf"
      key: "RekeyLimit"
      value: "1G 1h"
      reload: "sshd"

  - default: true
    check:
      method: config_value
      path: "/etc/ssh/sshd_config"
      key: "RekeyLimit"
      expected: "1G 1h"
    remediation:
      mechanism: config_set
      path: "/etc/ssh/sshd_config"
      key: "RekeyLimit"
      value: "1G 1h"
      separator: " "
      reload: "sshd"
