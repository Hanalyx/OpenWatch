id: ssh-use-pam
title: Enable PAM authentication for SSH
description: >
  The SSH daemon must use PAM (Pluggable Authentication Modules) for
  session and authentication processing. PAM provides centralized
  enforcement of password policies, account lockout, and session controls
  that are not available through SSH-native authentication alone.

rationale: >
  Without PAM integration, SSH bypasses system-wide authentication
  policies including password complexity requirements, account expiration,
  and login attempt limits. An attacker could exploit weaker SSH-native
  authentication to circumvent hardened PAM configurations that protect
  against brute-force and credential-based attacks.

severity: high
category: access-control
tags: [ssh, authentication, pam]

references:
  cis:
    rhel10_v1:  { section: "5.1.22", level: "L1", type: "Automated" }
    rhel8_v4:  { section: "5.1.24", level: "L1", type: "Automated" }
    rhel9_v2:  { section: "5.1.22", level: "L1", type: "Automated" }
  stig:
    rhel8_v2r6:
      vuln_id: "V-230249"
      stig_id: "RHEL-08-010260"
      severity: "CAT II"
      cci: ["CCI-000770"]
    rhel9_v2r7:
      vuln_id: "V-257986"
      stig_id: "RHEL-09-255050"
      severity: "CAT I"
      cci: ["CCI-000770"]
  nist_800_53: ["IA-2", "IA-5(1)"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - when: sshd_config_d
    check:
      method: config_value
      path: "/etc/ssh/sshd_config.d"
      key: "UsePAM"
      expected: "yes"
      scan_pattern: "*.conf"
    remediation:
      mechanism: config_set_dropin
      dir: "/etc/ssh/sshd_config.d"
      file: "00-aegis-use-pam.conf"
      key: "UsePAM"
      value: "yes"
      reload: "sshd"

  - default: true
    check:
      method: config_value
      path: "/etc/ssh/sshd_config"
      key: "UsePAM"
      expected: "yes"
    remediation:
      mechanism: config_set
      path: "/etc/ssh/sshd_config"
      key: "UsePAM"
      value: "yes"
      separator: " "
      reload: "sshd"
