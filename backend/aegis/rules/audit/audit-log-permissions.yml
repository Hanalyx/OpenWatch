id: audit-log-permissions
title: Set permissions on audit log files
description: >
  All audit log files in /var/log/audit must have restrictive permissions
  (0600 or more restrictive) with root ownership to prevent unauthorized
  access.
rationale: >
  Audit log files contain detailed records of security-relevant events.
  Unauthorized access to these files could reveal security monitoring
  capabilities or allow attackers to tamper with evidence.
severity: high
category: audit
tags: [audit, permissions, logging, security]

references:
  cis:
    rhel9_v2:  { section: "6.3.4.2", level: "L2", type: "Automated" }
  nist_800_53: ["AU-9", "AC-6"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "find /var/log/audit -type f \\( ! -perm 600 -o ! -user root -o ! -group root \\) 2>/dev/null | head -1"
      expected_exit: 0
      expected_stdout: ""
    remediation:
      mechanism: command_exec
      run: "find /var/log/audit -type f -exec chmod 0600 {} \\; -exec chown root:root {} \\;"
