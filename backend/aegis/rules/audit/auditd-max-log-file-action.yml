id: auditd-max-log-file-action
title: Configure auditd max_log_file_action
description: >
  The auditd max_log_file_action must be configured to rotate logs when
  they reach maximum size. This ensures audit logs are preserved and not
  automatically deleted.
rationale: >
  When audit logs reach their maximum size, the configured action determines
  how auditd responds. Setting this to 'keep_logs' or 'rotate' ensures logs
  are preserved for forensic analysis rather than being deleted.
severity: medium
category: audit
tags: [audit, logging, rotation, configuration]

references:
  cis:
    rhel9_v2:  { section: "6.3.2.2", level: "L2", type: "Automated" }
  nist_800_53: ["AU-4", "AU-9"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: config_value
      path: "/etc/audit/auditd.conf"
      key: "max_log_file_action"
      expected: "keep_logs"
    remediation:
      mechanism: config_set
      path: "/etc/audit/auditd.conf"
      key: "max_log_file_action"
      value: "keep_logs"
      restart: "auditd"
