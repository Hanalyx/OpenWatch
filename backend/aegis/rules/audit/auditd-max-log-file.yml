id: auditd-max-log-file
title: Configure auditd max_log_file
description: >
  The auditd max_log_file parameter should be configured to an
  appropriate size to store sufficient audit log data.
rationale: >
  Setting an appropriate maximum log file size ensures audit data is
  retained for forensic analysis while preventing the audit partition
  from filling unexpectedly.
severity: low
category: audit
tags: [audit, logging, configuration, storage]

references:
  cis:
    rhel9_v2:  { section: "6.3.2.1", level: "L2", type: "Automated" }
  nist_800_53: ["AU-4"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "grep -E '^max_log_file\\s*=' /etc/audit/auditd.conf | grep -E '[0-9]+'"
      expected_exit: 0
    remediation:
      mechanism: config_set
      path: "/etc/audit/auditd.conf"
      key: "max_log_file"
      value: "8"
      restart: "auditd"
