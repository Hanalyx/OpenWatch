id: at-access-control
title: Configure at access control
description: >
  Access to the at command should be restricted using /etc/at.allow.
  When at.allow exists, only users listed can use the at command.
rationale: >
  The at command allows scheduling one-time tasks. Restricting access
  limits which users can schedule tasks, reducing the risk of
  unauthorized job scheduling.
severity: medium
category: filesystem
tags: [at, access-control, scheduling, security]

references:
  cis:
    rhel9_v2:  { section: "2.4.2.1", level: "L1", type: "Automated" }
  nist_800_53: ["AC-3", "AC-6"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      checks:
        - method: file_exists
          path: "/etc/at.allow"
        - method: file_permission
          path: "/etc/at.allow"
          mode: "0600"
          owner: "root"
          group: "root"
    remediation:
      steps:
        - mechanism: file_content
          path: "/etc/at.allow"
          content: "root\n"
          owner: "root"
          group: "root"
          mode: "0600"
        - mechanism: file_absent
          path: "/etc/at.deny"
