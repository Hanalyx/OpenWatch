id: cron-access-control
title: Configure cron access control
description: >
  Cron access should be restricted using /etc/cron.allow. When cron.allow
  exists, only users listed can use cron. The cron.deny file should not
  exist or be empty.
rationale: >
  Unrestricted cron access allows any user to schedule tasks. Limiting
  access to specific users reduces the attack surface and prevents
  unauthorized users from scheduling potentially malicious jobs.
severity: medium
category: filesystem
tags: [cron, access-control, security]

references:
  cis:
    rhel9_v2:  { section: "2.4.1.8", level: "L1", type: "Automated" }
  nist_800_53: ["AC-3", "AC-6"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      checks:
        - method: file_exists
          path: "/etc/cron.allow"
        - method: file_permission
          path: "/etc/cron.allow"
          mode: "0600"
          owner: "root"
          group: "root"
    remediation:
      steps:
        - mechanism: file_content
          path: "/etc/cron.allow"
          content: "root\n"
          owner: "root"
          group: "root"
          mode: "0600"
        - mechanism: file_absent
          path: "/etc/cron.deny"
