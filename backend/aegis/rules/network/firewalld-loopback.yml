id: firewalld-loopback
title: Configure firewalld loopback traffic rules
description: >
  Firewalld should be configured to allow loopback traffic and block any
  traffic from external sources claiming to originate from the loopback
  address.
rationale: >
  Loopback traffic is required for local system communication. However,
  traffic claiming to be from 127.0.0.0/8 arriving on non-loopback
  interfaces is likely spoofed and should be blocked.
severity: medium
category: network
tags: [firewall, loopback, network, security]

references:
  cis:
    rhel9_v2:  { section: "4.2.2", level: "L1", type: "Automated" }
  nist_800_53: ["SC-7", "AC-4"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "firewall-cmd --zone=trusted --list-interfaces 2>/dev/null | grep -q lo"
      expected_exit: 0
    remediation:
      mechanism: command_exec
      run: "firewall-cmd --permanent --zone=trusted --add-interface=lo && firewall-cmd --reload"
