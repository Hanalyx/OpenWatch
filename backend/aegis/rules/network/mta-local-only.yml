id: mta-local-only
title: Ensure MTA is configured for local-only mode
description: >
  Mail Transfer Agents (MTA) should be configured to only listen on the
  localhost interface (127.0.0.1) unless the system is a designated mail
  server.
rationale: >
  An MTA listening on all interfaces provides an unnecessary network
  service that could be exploited. Restricting to localhost allows local
  mail delivery for system notifications while reducing attack surface.
severity: medium
category: network
tags: [mail, mta, network, postfix, sendmail]

references:
  cis:
    rhel9_v2:  { section: "2.1.21", level: "L1", type: "Automated" }
  nist_800_53: ["CM-7", "SC-7"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "ss -lntu | grep ':25\\s' | grep -v '127.0.0.1:25' | grep -v '::1:25'"
      expected_exit: 1
    remediation:
      mechanism: manual
      note: >
        Configure your MTA to listen only on localhost. For Postfix, set
        'inet_interfaces = loopback-only' in /etc/postfix/main.cf and
        restart postfix. For Sendmail, configure the DAEMON_OPTIONS in
        /etc/mail/sendmail.mc.
