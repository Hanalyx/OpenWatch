id: service-disable-debug-shell
title: Disable debug-shell service
description: >
  The debug-shell service provides a root shell on tty9 during boot
  for debugging purposes. It should be disabled in production.
rationale: >
  The debug-shell provides unauthenticated root access during boot,
  which could be exploited by attackers with physical access to
  gain complete control of the system.
severity: high
category: services
tags: [service, debug, console, physical-security, stig]

references:
  stig:
    rhel9_v2r7:
      vuln_id: "V-257798"
      stig_id: "RHEL-09-211030"
      severity: "CAT I"
  nist_800_53: ["AC-3", "IA-2"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "systemctl is-enabled debug-shell.service 2>/dev/null | grep -q 'masked\\|disabled' || systemctl is-enabled debug-shell.service 2>&1 | grep -q 'No such file'"
      expected_exit: 0
    remediation:
      mechanism: service_masked
      name: "debug-shell"
