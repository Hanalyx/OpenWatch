id: crypto-policy-no-weak
title: Disable weak cryptographic algorithms
description: >
  The system must not allow the use of weak cryptographic algorithms
  such as DES, 3DES, RC4, or MD5 for cryptographic operations.
rationale: >
  Weak cryptographic algorithms can be broken with modern computing
  power, compromising the confidentiality and integrity of encrypted
  data. Only strong algorithms should be permitted.
severity: high
category: system
tags: [crypto-policy, cryptography, weak-algorithms, stig]

references:
  stig:
    rhel9_v2r7:
      vuln_id: "V-257789"
      stig_id: "RHEL-09-671020"
      severity: "CAT II"
  nist_800_53: ["SC-12", "SC-13"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "update-crypto-policies --show | grep -qvE 'LEGACY|DEFAULT:.*weak'"
      expected_exit: 0
    remediation:
      mechanism: command_exec
      run: "update-crypto-policies --set DEFAULT"
