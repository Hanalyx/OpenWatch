id: crypto-policy-not-overridden
title: Ensure crypto policy is not overridden
description: >
  The system-wide cryptographic policy must not be overridden
  by individual applications or configuration files.
rationale: >
  Overriding crypto policy allows use of weak algorithms that
  could compromise security of encrypted communications.
severity: critical
category: system
tags: [crypto, security, policy]

references:
  stig:
    rhel9_v2r7:
      vuln_id: "V-258236"
      stig_id: "RHEL-09-672025"
      severity: "CAT I"
  nist_800_53: ["SC-13", "IA-7"]

platforms:
  - family: rhel
    min_version: 9

implementations:
  - default: true
    check:
      method: command
      run: "ls /etc/crypto-policies/local.d/*.pmod 2>/dev/null | wc -l | grep -q '^0$'"
      expected_exit: 0
    remediation:
      mechanism: manual
      note: "Remove any .pmod files from /etc/crypto-policies/local.d/ that override the system crypto policy"
