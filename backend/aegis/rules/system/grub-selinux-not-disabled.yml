id: grub-selinux-not-disabled
title: Ensure SELinux is not disabled in bootloader configuration
description: >
  The selinux=0 kernel parameter must not be set in GRUB configuration.
  This parameter completely disables SELinux at boot time.
rationale: >
  SELinux provides mandatory access controls that protect system
  integrity. Disabling it at boot time removes all security protections
  provided by SELinux policies.
severity: high
category: system
tags: [grub, selinux, boot, security]

references:
  cis:
    rhel9_v2:  { section: "1.3.1.2", level: "L1", type: "Automated" }
  stig:
    rhel9_v2r7:
      vuln_id: "V-258077"
      stig_id: "RHEL-09-431015"
      severity: "CAT II"
  nist_800_53: ["AC-3", "AC-6"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "grubby --info=ALL 2>/dev/null | grep -E '^args=.*selinux=0' | head -1"
      expected_exit: 0
      expected_stdout: ""
    remediation:
      mechanism: command_exec
      run: "grubby --update-kernel=ALL --remove-args='selinux=0'"
