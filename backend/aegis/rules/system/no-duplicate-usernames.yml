id: no-duplicate-usernames
title: Ensure no duplicate user names exist
description: >
  All user names in /etc/passwd must be unique. Duplicate user names
  can cause unpredictable behavior and security issues.
rationale: >
  Duplicate user names can lead to confusion about which account is being
  used and may result in unauthorized access if users share the same name
  with different UIDs.
severity: high
category: system
tags: [accounts, passwd, security]

references:
  cis:
    rhel9_v2:  { section: "7.2.6", level: "L1", type: "Automated" }
  nist_800_53: ["IA-2", "AC-2"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: command
      run: "cut -d: -f1 /etc/passwd | sort | uniq -d"
      expected_exit: 0
      expected_stdout: ""
    remediation:
      mechanism: manual
      description: >
        Review /etc/passwd and resolve any duplicate user names by either
        removing the duplicate accounts or renaming them to unique values.
