id: no-graphical-target
title: Ensure graphical target is not the default
description: >
  The system's default systemd target should not be graphical.target on
  servers. Server systems should boot to multi-user.target to reduce
  attack surface and resource usage.
rationale: >
  Running a graphical user interface on servers increases the attack
  surface by loading display managers, X servers, and desktop services.
  These provide additional potential vulnerabilities without benefit on
  headless systems.
severity: low
category: system
tags: [systemd, target, gui, attack-surface]

references:
  cis:
    rhel9_v2:  { section: "1.8.1", level: "L1", type: "Automated" }
  nist_800_53: ["CM-7"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: systemd_target
      not_expected: "graphical.target"
    remediation:
      mechanism: command_exec
      run: "systemctl set-default multi-user.target"
