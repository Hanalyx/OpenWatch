id: selinux-policy-targeted
title: Set SELinux policy to targeted
description: >
  SELinux must use the targeted policy type to provide appropriate
  mandatory access control for system services.
rationale: >
  The targeted policy confines network-facing services while allowing
  most user processes to run unconfined. This provides a practical
  balance of security and usability.
severity: medium
category: system
tags: [selinux, policy, mandatory-access-control, stig]

references:
  cis:
    rhel9_v2:  { section: "1.6.1.3", level: "L1", type: "Automated" }
  stig:
    rhel9_v2r7:
      vuln_id: "V-257812"
      stig_id: "RHEL-09-431015"
      severity: "CAT II"
  nist_800_53: ["AC-3"]

platforms:
  - family: rhel
    min_version: 8

implementations:
  - default: true
    check:
      method: config_value
      path: "/etc/selinux/config"
      key: "SELINUXTYPE"
      expected: "targeted"
    remediation:
      mechanism: config_set
      path: "/etc/selinux/config"
      key: "SELINUXTYPE"
      value: "targeted"
      separator: "="
