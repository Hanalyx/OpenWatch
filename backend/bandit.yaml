# Bandit Security Scanner Configuration
# https://bandit.readthedocs.io/en/latest/config.html

# Test profiles
tests:
  - B201  # flask_debug_true
  - B301  # pickle (insecure deserialization)
  - B302  # marshal (insecure deserialization)
  - B303  # md5/sha1 (weak cryptography)
  - B304  # insecure ciphers
  - B305  # insecure cipher modes
  - B306  # insecure tempfile usage
  - B307  # eval() usage
  - B308  # mark_safe() usage
  - B310  # urllib urlopen (SSRF)
  - B311  # random instead of secrets
  - B312  # telnetlib (insecure protocol)
  - B313  # xml (external entity injection)
  - B314  # xml.etree.ElementTree (XXE)
  - B315  # xml.expat (XXE)
  - B316  # xml.sax (XXE)
  - B317  # xml.minidom (XXE)
  - B318  # xml.pulldom (XXE)
  - B319  # xml (lxml XXE)
  - B320  # xml.etree.cElementTree (XXE)
  - B321  # ftplib (insecure protocol)
  - B322  # input() usage
  - B323  # unverified SSL context
  - B324  # hashlib.md5/sha1
  - B325  # tempfile.mktemp
  - B401  # import_telnetlib
  - B402  # import_ftplib
  - B403  # import_pickle
  - B404  # import_subprocess
  - B405  # import_xml_etree
  - B406  # import_xml_sax
  - B407  # import_xml_expat
  - B408  # import_xml_minidom
  - B409  # import_xml_pulldom
  - B410  # import_lxml
  - B411  # import_xmlrpclib
  - B412  # import_httpoxy
  - B413  # import_pycrypto
  - B501  # request_with_no_cert_validation
  - B502  # ssl_with_bad_version
  - B503  # ssl_with_bad_defaults
  - B504  # ssl_with_no_version
  - B505  # weak_cryptographic_key
  - B506  # yaml_load
  - B507  # ssh_no_host_key_verification
  - B601  # paramiko_calls
  - B602  # shell_injection (subprocess with shell=True)
  - B603  # subprocess_without_shell_equals_true
  - B604  # any_other_function_with_shell_equals_true
  - B605  # start_process_with_a_shell
  - B606  # start_process_with_no_shell
  - B607  # start_process_with_partial_path
  - B608  # hardcoded_sql_expressions
  - B609  # linux_commands_wildcard_injection
  - B610  # django_extra_used
  - B611  # django_rawsql_used
  - B701  # jinja2_autoescape_false
  - B702  # use_of_mako_templates
  - B703  # django_mark_safe

# Exclude paths
exclude_dirs:
  - /tests
  - /test
  - /.venv
  - /venv
  - /env
  - /.env
  - /node_modules
  - /__pycache__
  - /.pytest_cache
  - /.mypy_cache
  - /build
  - /dist

# Skips (specific issues to ignore)
skips:
  - B101  # assert_used (we use asserts in tests)
  - B104  # hardcoded_bind_all_interfaces (0.0.0.0 is intentional in Docker)
  - B110  # try_except_pass (sometimes necessary)

# Severity levels
# LOW, MEDIUM, HIGH
severity:
  - MEDIUM
  - HIGH

# Confidence levels
# LOW, MEDIUM, HIGH
confidence:
  - MEDIUM
  - HIGH

# Output format
# Options: csv, json, txt, html, yaml
format: txt

# Show only issues at specified severity and confidence levels
# If not set, all issues are reported
aggregate: file

# Bandit will exit with return code 1 if any issues are found
# Options: all, high, medium, low
level:
  - MEDIUM
  - HIGH
