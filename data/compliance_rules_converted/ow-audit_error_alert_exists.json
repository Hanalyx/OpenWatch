{
  "_id": "ow-audit_error_alert_exists",
  "rule_id": "ow-audit_error_alert_exists",
  "scap_rule_id": "xccdf_org.ssgproject.content_rule_audit_error_alert_exists",
  "parent_rule_id": null,
  "metadata": {
    "name": "Ensure that Audit Log Errors Emit Alerts",
    "description": "<p>\nOpenShift audit works at the API server level, logging all requests coming to the server.\nHowever, if API server instance is unable to write errors, an alert must be issued\nin order for the organization to take a relevant action. e.g. shutting down that instance.\n</p>\n<p>\nKubernetes by default has metrics that enable one to write such alerts:\n</p>\n\n<ul>\n  <li><tt>apiserver_audit_event_total</tt></li>\n  <li><tt>apiserver_audit_error_total</tt></li>\n</ul>\n\nSuch an example is shipped in OCP 4.9+\n\n<pre>\napiVersion: monitoring.coreos.com/v1\nkind: PrometheusRule\nmetadata:\n  name: audit-errors\n  namespace: openshift-kube-apiserver\nspec:\n  groups:\n  - name: apiserver-audit\n    rules:\n    - alert: AuditLogError\n      annotations:\n        summary: |-\n          An API Server instance was unable to write audit logs. This could be\n          triggered by the node running out of space, or a malicious actor\n          tampering with the audit logs.\n        description: An API Server had an error writing to an audit log.\n      expr: |\n        sum by (apiserver,instance)(rate(apiserver_audit_error_total{apiserver=~\".+-apiserver\"}[5m])) / sum by (apiserver,instance) (rate(apiserver_audit_event_total{apiserver=~\".+-apiserver\"}[5m])) > 0\n      for: 1m\n      labels:\n        severity: warning\n</pre>\n\n<p>\nFor more information, consult the\n{{{ weblink(link=\"https://docs.openshift.com/container-platform/latest/logging/cluster-logging-external.html\",\n            text=\"official Kubernetes documentation\") }}}.\n</p>",
    "rationale": "When there are errors writing audit logs, security events will not be logged\nby that specific API Server instance. Security Incident Response teams use\nthese audit logs, amongst other artifacts, to determine the impact of\nsecurity breaches or events. Without these logs, it becomes very difficult\nto assess a situation and do appropriate root cause analysis in such incidents.",
    "source": {
      "upstream_id": "audit_error_alert_exists",
      "complianceascode_version": "0.1.73",
      "source_file": "converted_from_yaml",
      "cce_id": "CCE-90744-4",
      "imported_at": "2025-10-03T02:25:59.502904+00:00"
    }
  },
  "abstract": false,
  "severity": "high",
  "category": "audit_logging",
  "security_function": "access_control",
  "tags": [
    "severity_high",
    "converted",
    "scap",
    "ssg"
  ],
  "frameworks": {
    "nist": {
      "800-53r5": [
        "AU-5"
      ]
    },
    "stig": {
      "current": [
        "SRG-APP-000109-CTR-000215"
      ]
    }
  },
  "platform_implementations": {
    "rhel": {
      "versions": [
        "8",
        "9"
      ],
      "check_method": "custom",
      "check_command": "# TODO: Implement yamlfile_value check",
      "enable_command": "# TODO: Implement yamlfile_value remediation",
      "service_dependencies": []
    }
  },
  "platform_requirements": {
    "required_capabilities": [],
    "excluded_environments": []
  },
  "check_type": "template",
  "check_content": {
    "scap_rule_id": "xccdf_org.ssgproject.content_rule_audit_error_alert_exists",
    "method": "xccdf_evaluation",
    "expected_result": "pass"
  },
  "fix_available": true,
  "fix_content": {},
  "manual_remediation": "<p>\nOpenShift audit works at the API server level, logging all requests coming to the server.\nHowever, if API server instance is unable to write errors, an alert must be issued\nin order for the organization to take a relevant action. e.g. shutting down that instance.\n</p>\n<p>\nKubernetes by default has metrics that enable one to write such alerts:\n</p>\n\n<ul>\n  <li><tt>apiserver_audit_event_total</tt></li>\n  <li><tt>apiserver_audit_error_total</tt></li>\n</ul>\n\nSuch an example is shipped in OCP 4.9+\n\n<pre>\napiVersion: monitoring.coreos.com/v1\nkind: PrometheusRule\nmetadata:\n  name: audit-errors\n  namespace: openshift-kube-apiserver\nspec:\n  groups:\n  - name: apiserver-audit\n    rules:\n    - alert: AuditLogError\n      annotations:\n        summary: |-\n          An API Server instance was unable to write audit logs. This could be\n          triggered by the node running out of space, or a malicious actor\n          tampering with the audit logs.\n        description: An API Server had an error writing to an audit log.\n      expr: |\n        sum by (apiserver,instance)(rate(apiserver_audit_error_total{apiserver=~\".+-apiserver\"}[5m])) / sum by (apiserver,instance) (rate(apiserver_audit_event_total{apiserver=~\".+-apiserver\"}[5m])) > 0\n      for: 1m\n      labels:\n        severity: warning\n</pre>\n\n<p>\nFor more information, consult the\n{{{ weblink(link=\"https://docs.openshift.com/container-platform/latest/logging/cluster-logging-external.html\",\n            text=\"official Kubernetes documentation\") }}}.\n</p>",
  "remediation_complexity": "medium",
  "remediation_risk": "low",
  "dependencies": {
    "requires": [],
    "conflicts": [],
    "related": []
  },
  "source_file": "applications/openshift/logging/audit_error_alert_exists/rule.yml",
  "source_hash": "sha256:6e1b7f01d1abb9fe",
  "version": "2024.2",
  "imported_at": "2025-10-03T02:25:59.503030+00:00",
  "updated_at": "2025-10-03T02:25:59.503033+00:00",
  "identifiers": {
    "cce": "CCE-90744-4"
  }
}