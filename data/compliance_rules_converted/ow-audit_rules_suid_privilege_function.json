{
  "_id": "ow-audit_rules_suid_privilege_function",
  "rule_id": "ow-audit_rules_suid_privilege_function",
  "scap_rule_id": "xccdf_org.ssgproject.content_rule_audit_rules_suid_privilege_function",
  "parent_rule_id": null,
  "metadata": {
    "name": "Record Events When Privileged Executables Are Run",
    "description": "Verify the system generates an audit record when privileged functions are executed.\n\nIf audit is using the \"auditctl\" tool to load the rules, run the following command:\n\n<pre>$ sudo grep execve /etc/audit/audit.rules</pre>\n\nIf audit is using the \"augenrules\" tool to load the rules, run the following command:\n\n<pre>$ sudo grep -r execve /etc/audit/rules.d</pre>\n\n{{% if product in [\"ol8\"] %}}\n<pre>-a always,exit -F arch=b32 -S execve -C uid!=euid -k setuid</pre>\n<pre>-a always,exit -F arch=b64 -S execve -C uid!=euid -k setuid</pre>\n<pre>-a always,exit -F arch=b32 -S execve -C gid!=egid -k setgid</pre>\n<pre>-a always,exit -F arch=b64 -S execve -C gid!=egid -k setgid</pre>\n{{% else %}}\n<pre>-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k setuid</pre>\n<pre>-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k setuid</pre>\n<pre>-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k setgid</pre>\n<pre>-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k setgid</pre>\n{{% endif %}}\n\nIf both the \"b32\" and \"b64\" audit rules for \"SUID\" files are not defined, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules for \"SGID\" files are not defined, this is a finding.",
    "rationale": "Misuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have\ncompromised information system accounts, is a serious and ongoing concern\nand can have significant adverse impacts on organizations. Auditing the use\nof privileged functions is one way to detect such misuse and identify the\nrisk from insider threats and the advanced persistent threat.",
    "source": {
      "upstream_id": "audit_rules_suid_privilege_function",
      "complianceascode_version": "0.1.73",
      "source_file": "converted_from_yaml",
      "cce_id": "CCE-87439-6",
      "imported_at": "2025-10-03T02:25:56.537122+00:00"
    }
  },
  "abstract": false,
  "severity": "medium",
  "category": "audit_logging",
  "security_function": "access_control",
  "tags": [
    "converted",
    "scap",
    "ssg",
    "severity_medium"
  ],
  "frameworks": {
    "nist": {
      "800-53r5": [
        "CM-5(1)",
        "AU-7(a)",
        "AU-7(b)",
        "AU-8(b)",
        "AU-12(3)",
        "AC-6(9)"
      ]
    },
    "stig": {
      "current": [
        "SRG-OS-000326-GPOS-00126",
        "SRG-OS-000327-GPOS-00127",
        "SRG-APP-000343-CTR-000780",
        "SRG-APP-000381-CTR-000905",
        "SRG-OS-000755-GPOS-00220",
        "OL07-00-030360",
        "OL08-00-030000",
        "SLES-12-020240",
        "SLES-15-030640"
      ]
    }
  },
  "platform_implementations": {},
  "platform_requirements": {
    "required_capabilities": [],
    "excluded_environments": []
  },
  "check_type": "scap",
  "check_content": {
    "scap_rule_id": "xccdf_org.ssgproject.content_rule_audit_rules_suid_privilege_function",
    "method": "xccdf_evaluation",
    "expected_result": "pass"
  },
  "fix_available": false,
  "fix_content": {},
  "manual_remediation": "Verify the system generates an audit record when privileged functions are executed.\n\nIf audit is using the \"auditctl\" tool to load the rules, run the following command:\n\n<pre>$ sudo grep execve /etc/audit/audit.rules</pre>\n\nIf audit is using the \"augenrules\" tool to load the rules, run the following command:\n\n<pre>$ sudo grep -r execve /etc/audit/rules.d</pre>\n\n{{% if product in [\"ol8\"] %}}\n<pre>-a always,exit -F arch=b32 -S execve -C uid!=euid -k setuid</pre>\n<pre>-a always,exit -F arch=b64 -S execve -C uid!=euid -k setuid</pre>\n<pre>-a always,exit -F arch=b32 -S execve -C gid!=egid -k setgid</pre>\n<pre>-a always,exit -F arch=b64 -S execve -C gid!=egid -k setgid</pre>\n{{% else %}}\n<pre>-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k setuid</pre>\n<pre>-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k setuid</pre>\n<pre>-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k setgid</pre>\n<pre>-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k setgid</pre>\n{{% endif %}}\n\nIf both the \"b32\" and \"b64\" audit rules for \"SUID\" files are not defined, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules for \"SGID\" files are not defined, this is a finding.",
  "remediation_complexity": "medium",
  "remediation_risk": "low",
  "dependencies": {
    "requires": [],
    "conflicts": [],
    "related": []
  },
  "source_file": "linux_os/guide/auditing/auditd_configure_rules/audit_rules_suid_privilege_function/rule.yml",
  "source_hash": "sha256:0d7e6d0517f14944",
  "version": "2024.2",
  "imported_at": "2025-10-03T02:25:56.537230+00:00",
  "updated_at": "2025-10-03T02:25:56.537233+00:00",
  "identifiers": {
    "cce": "CCE-87439-6"
  }
}