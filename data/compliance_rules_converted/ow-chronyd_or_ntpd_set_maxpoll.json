{
  "_id": "ow-chronyd_or_ntpd_set_maxpoll",
  "rule_id": "ow-chronyd_or_ntpd_set_maxpoll",
  "scap_rule_id": "xccdf_org.ssgproject.content_rule_chronyd_or_ntpd_set_maxpoll",
  "parent_rule_id": null,
  "metadata": {
    "name": "Configure Time Service Maxpoll Interval",
    "description": "The <tt>maxpoll</tt> should be configured to\n{{{ xccdf_value(\"var_time_service_set_maxpoll\") }}} in <tt>/etc/ntp.conf</tt> or\n<tt>{{{ chrony_conf_path }}}</tt> (or <tt>{{{ chrony_d_path }}}</tt>) to continuously poll time servers. To configure\n<tt>maxpoll</tt> in <tt>/etc/ntp.conf</tt> or <tt>{{{ chrony_conf_path }}}</tt> (or <tt>{{{ chrony_d_path }}}</tt>)\nadd the following after each <tt>server</tt>, <tt>pool</tt> or <tt>peer</tt> entry:\n<pre>maxpoll {{{ xccdf_value(\"var_time_service_set_maxpoll\") }}}</pre>\nto <tt>server</tt> directives. If using chrony, any <tt>pool</tt> directives\nshould be configured too.\n\n{{% if product == \"rhcos4\" %}}\n<p>\nNote that if the remediation shipping with this content is being used, the\n<b>MachineConfig</b> shipped does not include reference NTP servers to point\nto. It is up to the admin to set these which will vary depending on the\ncluster's requirements.\n</p>\n\n<p>\nThe aforementioned remediation does include the directory <tt>/etc/chrony.d</tt>\nwhich would allow the creation of configuration files to set these servers.\n</p>\n\nIf we'd like to set a configuration like the following:\n<pre>\npool 2.rhel.pool.ntp.org iburst\n\nserver 0.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 1.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 2.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 3.rhel.pool.ntp.org minpoll 4 maxpoll 10\n</pre>\n\nThis could be done with to the following manifest:\n\n<pre>\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n  labels:\n    machineconfiguration.openshift.io/role: master\n  name: 75-master-chrony-servers\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,pool%202.rhel.pool.ntp.org%20iburst%0A%0Aserver%200.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%201.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%202.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%203.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010\n        mode: 0600\n        path: /etc/chrony.d/10-rhel-pool-and-servers.conf\n        overwrite: true\n</pre>\n\nNote that this needs to be done for each <pre>MachineConfigPool</pre>\n{{% endif %}}",
    "rationale": "Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside the configured acceptable allowance (drift) may be inaccurate.\nSynchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.\nOrganizations should consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints).",
    "source": {
      "upstream_id": "chronyd_or_ntpd_set_maxpoll",
      "complianceascode_version": "0.1.73",
      "source_file": "converted_from_yaml",
      "cce_id": "CCE-82684-2",
      "imported_at": "2025-10-03T02:25:57.073307+00:00"
    }
  },
  "abstract": false,
  "severity": "medium",
  "category": "system_hardening",
  "security_function": "access_control",
  "tags": [
    "converted",
    "scap",
    "ssg",
    "severity_medium"
  ],
  "frameworks": {
    "cis": {
      "controls_v8": [
        "1",
        "14",
        "15",
        "16",
        "3",
        "5",
        "6"
      ]
    },
    "iso27001": {
      "2013": [
        "A.12.4.1",
        "A.12.4.2",
        "A.12.4.3",
        "A.12.4.4",
        "A.12.7.1"
      ]
    },
    "nist": {
      "800-53r5": [
        "CM-6(a)",
        "AU-8(1)(b)",
        "AU-12(1)",
        "PR.PT-1",
        "AU-8(1)(a)",
        "AU-8(1)(b)"
      ]
    },
    "stig": {
      "current": [
        "SRG-OS-000355-GPOS-00143",
        "SRG-OS-000356-GPOS-00144",
        "SRG-OS-000359-GPOS-00146",
        "OL07-00-040500",
        "OL08-00-030740",
        "SLES-12-030300",
        "SLES-15-010400"
      ]
    }
  },
  "platform_implementations": {},
  "platform_requirements": {
    "required_capabilities": [],
    "excluded_environments": []
  },
  "check_type": "scap",
  "check_content": {
    "scap_rule_id": "xccdf_org.ssgproject.content_rule_chronyd_or_ntpd_set_maxpoll",
    "method": "xccdf_evaluation",
    "expected_result": "pass"
  },
  "fix_available": false,
  "fix_content": {},
  "manual_remediation": "The <tt>maxpoll</tt> should be configured to\n{{{ xccdf_value(\"var_time_service_set_maxpoll\") }}} in <tt>/etc/ntp.conf</tt> or\n<tt>{{{ chrony_conf_path }}}</tt> (or <tt>{{{ chrony_d_path }}}</tt>) to continuously poll time servers. To configure\n<tt>maxpoll</tt> in <tt>/etc/ntp.conf</tt> or <tt>{{{ chrony_conf_path }}}</tt> (or <tt>{{{ chrony_d_path }}}</tt>)\nadd the following after each <tt>server</tt>, <tt>pool</tt> or <tt>peer</tt> entry:\n<pre>maxpoll {{{ xccdf_value(\"var_time_service_set_maxpoll\") }}}</pre>\nto <tt>server</tt> directives. If using chrony, any <tt>pool</tt> directives\nshould be configured too.\n\n{{% if product == \"rhcos4\" %}}\n<p>\nNote that if the remediation shipping with this content is being used, the\n<b>MachineConfig</b> shipped does not include reference NTP servers to point\nto. It is up to the admin to set these which will vary depending on the\ncluster's requirements.\n</p>\n\n<p>\nThe aforementioned remediation does include the directory <tt>/etc/chrony.d</tt>\nwhich would allow the creation of configuration files to set these servers.\n</p>\n\nIf we'd like to set a configuration like the following:\n<pre>\npool 2.rhel.pool.ntp.org iburst\n\nserver 0.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 1.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 2.rhel.pool.ntp.org minpoll 4 maxpoll 10\nserver 3.rhel.pool.ntp.org minpoll 4 maxpoll 10\n</pre>\n\nThis could be done with to the following manifest:\n\n<pre>\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n  labels:\n    machineconfiguration.openshift.io/role: master\n  name: 75-master-chrony-servers\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,pool%202.rhel.pool.ntp.org%20iburst%0A%0Aserver%200.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%201.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%202.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010%0Aserver%203.rhel.pool.ntp.org%20minpoll%204%20maxpoll%2010\n        mode: 0600\n        path: /etc/chrony.d/10-rhel-pool-and-servers.conf\n        overwrite: true\n</pre>\n\nNote that this needs to be done for each <pre>MachineConfigPool</pre>\n{{% endif %}}",
  "remediation_complexity": "medium",
  "remediation_risk": "low",
  "dependencies": {
    "requires": [],
    "conflicts": [],
    "related": []
  },
  "source_file": "linux_os/guide/services/ntp/chronyd_or_ntpd_set_maxpoll/rule.yml",
  "source_hash": "sha256:c82e441c0e67d5af",
  "version": "2024.2",
  "imported_at": "2025-10-03T02:25:57.073424+00:00",
  "updated_at": "2025-10-03T02:25:57.073426+00:00",
  "identifiers": {
    "cce": "CCE-82684-2"
  }
}