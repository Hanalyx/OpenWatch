{
  "_id": "ow-file_permissions_proxy_kubeconfig",
  "rule_id": "ow-file_permissions_proxy_kubeconfig",
  "scap_rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_proxy_kubeconfig",
  "parent_rule_id": null,
  "metadata": {
    "name": "Verify Permissions on the Worker Proxy Kubeconfig File",
    "description": "To ensure the Kubernetes ConfigMap is mounted into the sdn daemonset pods with the\ncorrect permissions, make sure that the <tt>sdn-config</tt> ConfigMap is mounted using\nrestrictive permissions. Check that the <tt>config</tt> VolumeMount mounts the\n<tt>sdn-config</tt> configMap with permissions set to 420:\n<pre>\n{\n\"configMap\": {\n  \"defaultMode\": 420,\n  \"name\": \"sdn-config\"\n  },\n\"name\": \"config\"\n}\n</pre>",
    "rationale": "The kube-proxy kubeconfig file controls various parameters of the kube-proxy\nservice in the worker node. If used, you should restrict its file permissions\nto maintain the integrity of the file. The file should be writable by only\nthe administrators on the system.\n\nThe kube-proxy runs with the kubeconfig parameters configured as\na Kubernetes ConfigMap instead of a file. In this case, there is no proxy\nkubeconfig file. But appropriate permissions still need to be set in the\nConfigMap mount.",
    "source": {
      "upstream_id": "file_permissions_proxy_kubeconfig",
      "complianceascode_version": "0.1.73",
      "source_file": "converted_from_yaml",
      "cce_id": "CCE-84047-0",
      "imported_at": "2025-10-03T02:25:59.173815+00:00"
    }
  },
  "abstract": false,
  "severity": "medium",
  "category": "access_control",
  "security_function": "access_control",
  "tags": [
    "converted",
    "scap",
    "ssg",
    "severity_medium"
  ],
  "frameworks": {
    "cis": {
      "controls_v8": [
        "4.1.3"
      ]
    },
    "nist": {
      "800-53r5": [
        "CM-6",
        "CM-6(1)"
      ]
    },
    "pci": {
      "v4.0": [
        "Req-2.2"
      ]
    },
    "stig": {
      "current": [
        "SRG-APP-000516-CTR-001325"
      ]
    }
  },
  "platform_implementations": {
    "rhel": {
      "versions": [
        "8",
        "9"
      ],
      "check_method": "custom",
      "check_command": "# TODO: Implement yamlfile_value check",
      "enable_command": "# TODO: Implement yamlfile_value remediation",
      "service_dependencies": []
    }
  },
  "platform_requirements": {
    "required_capabilities": [],
    "excluded_environments": []
  },
  "check_type": "template",
  "check_content": {
    "scap_rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_proxy_kubeconfig",
    "method": "xccdf_evaluation",
    "expected_result": "pass"
  },
  "fix_available": true,
  "fix_content": {},
  "manual_remediation": "To ensure the Kubernetes ConfigMap is mounted into the sdn daemonset pods with the\ncorrect permissions, make sure that the <tt>sdn-config</tt> ConfigMap is mounted using\nrestrictive permissions. Check that the <tt>config</tt> VolumeMount mounts the\n<tt>sdn-config</tt> configMap with permissions set to 420:\n<pre>\n{\n\"configMap\": {\n  \"defaultMode\": 420,\n  \"name\": \"sdn-config\"\n  },\n\"name\": \"config\"\n}\n</pre>",
  "remediation_complexity": "medium",
  "remediation_risk": "low",
  "dependencies": {
    "requires": [],
    "conflicts": [],
    "related": []
  },
  "source_file": "applications/openshift/worker/file_permissions_proxy_kubeconfig/rule.yml",
  "source_hash": "sha256:bdb8ca49b3853265",
  "version": "2024.2",
  "imported_at": "2025-10-03T02:25:59.173947+00:00",
  "updated_at": "2025-10-03T02:25:59.173950+00:00",
  "identifiers": {
    "cce": "CCE-84047-0"
  }
}