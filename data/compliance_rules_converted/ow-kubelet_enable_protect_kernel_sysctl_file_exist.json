{
  "_id": "ow-kubelet_enable_protect_kernel_sysctl_file_exist",
  "rule_id": "ow-kubelet_enable_protect_kernel_sysctl_file_exist",
  "scap_rule_id": "xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_sysctl_file_exist",
  "parent_rule_id": null,
  "metadata": {
    "name": "kubelet - Set Up Sysctl to Enable Protect Kernel Defaults - Check sysctl configuration file exist",
    "description": "<p>\nSetup required tuned kernel parameters before enabling overwritten protection.\n</p>\n\n<p>\nBefore enabling kernel parameter overwritten protection default, \nit's important and necessary to first create a <tt>MachineConfig</tt>\nobject that persist the required sysctl's. The required sysctl's are the following:\n</p>\n\n<pre>\nkernel.keys.root_maxbytes=25000000\nkernel.keys.root_maxkeys=1000000\nkernel.panic=10\nkernel.panic_on_oops=1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\n</pre>\n\n<p>\nThe these need to be enabled via MachineConfig since they need to be\navailable as soon as the node starts and before the Kubelet does.\nThe manifest may look as follows:\n</p>\n\n<pre>\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n  labels:\n    machineconfiguration.openshift.io/role: master\n  name: 75-master-kubelet-sysctls\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,vm.overcommit_memory%3D1%0Avm.panic_on_oom%3D0%0Akernel.panic%3D10%0Akernel.panic_on_oops%3D1%0Akernel.keys.root_maxkeys%3D1000000%0Akernel.keys.root_maxbytes%3D25000000%0A\n        mode: 0644\n        path: /etc/sysctl.d/90-kubelet.conf\n        overwrite: true\n</pre>\n\n<p>\nThis will need to be done for each relevant <tt>MachineConfigPool</tt>\nin the cluster.\n</p>\n\n<p>\nTo configure, follow the directions in\n{{{ weblink(link=\"https://docs.openshift.com/container-platform/4.6/nodes/nodes/nodes-nodes-managing.html\",\n            text=\"the documentation\") }}}\n</p>",
    "rationale": "Kernel parameters are usually tuned and hardened by the system administrators\nbefore putting the systems into production. These parameters protect the\nkernel and the system. Your kubelet kernel defaults that rely on such\nparameters should be appropriately set to match the desired secured system\nstate. Ignoring this could potentially lead to running pods with undesired\nkernel behavior.",
    "source": {
      "upstream_id": "kubelet_enable_protect_kernel_sysctl_file_exist",
      "complianceascode_version": "0.1.73",
      "source_file": "converted_from_yaml",
      "cce_id": "",
      "imported_at": "2025-10-03T02:25:59.289307+00:00"
    }
  },
  "abstract": false,
  "severity": "medium",
  "category": "system_hardening",
  "security_function": "access_control",
  "tags": [
    "converted",
    "scap",
    "ssg",
    "severity_medium"
  ],
  "frameworks": {
    "nist": {
      "800-53r5": [
        "CM-6",
        "CM-6(1)"
      ]
    }
  },
  "platform_implementations": {
    "rhel": {
      "versions": [
        "8",
        "9"
      ],
      "check_method": "custom",
      "check_command": "# TODO: Implement file_existence check",
      "enable_command": "# TODO: Implement file_existence remediation",
      "service_dependencies": []
    }
  },
  "platform_requirements": {
    "required_capabilities": [],
    "excluded_environments": []
  },
  "check_type": "template",
  "check_content": {
    "scap_rule_id": "xccdf_org.ssgproject.content_rule_kubelet_enable_protect_kernel_sysctl_file_exist",
    "method": "xccdf_evaluation",
    "expected_result": "pass"
  },
  "fix_available": true,
  "fix_content": {},
  "manual_remediation": "<p>\nSetup required tuned kernel parameters before enabling overwritten protection.\n</p>\n\n<p>\nBefore enabling kernel parameter overwritten protection default, \nit's important and necessary to first create a <tt>MachineConfig</tt>\nobject that persist the required sysctl's. The required sysctl's are the following:\n</p>\n\n<pre>\nkernel.keys.root_maxbytes=25000000\nkernel.keys.root_maxkeys=1000000\nkernel.panic=10\nkernel.panic_on_oops=1\nvm.overcommit_memory=1\nvm.panic_on_oom=0\n</pre>\n\n<p>\nThe these need to be enabled via MachineConfig since they need to be\navailable as soon as the node starts and before the Kubelet does.\nThe manifest may look as follows:\n</p>\n\n<pre>\n---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n  labels:\n    machineconfiguration.openshift.io/role: master\n  name: 75-master-kubelet-sysctls\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,vm.overcommit_memory%3D1%0Avm.panic_on_oom%3D0%0Akernel.panic%3D10%0Akernel.panic_on_oops%3D1%0Akernel.keys.root_maxkeys%3D1000000%0Akernel.keys.root_maxbytes%3D25000000%0A\n        mode: 0644\n        path: /etc/sysctl.d/90-kubelet.conf\n        overwrite: true\n</pre>\n\n<p>\nThis will need to be done for each relevant <tt>MachineConfigPool</tt>\nin the cluster.\n</p>\n\n<p>\nTo configure, follow the directions in\n{{{ weblink(link=\"https://docs.openshift.com/container-platform/4.6/nodes/nodes/nodes-nodes-managing.html\",\n            text=\"the documentation\") }}}\n</p>",
  "remediation_complexity": "medium",
  "remediation_risk": "low",
  "dependencies": {
    "requires": [],
    "conflicts": [],
    "related": []
  },
  "source_file": "applications/openshift/kubelet/kubelet_enable_protect_kernel_sysctl_file_exist/rule.yml",
  "source_hash": "sha256:e8bd559dcbb5dc9b",
  "version": "2024.2",
  "imported_at": "2025-10-03T02:25:59.289435+00:00",
  "updated_at": "2025-10-03T02:25:59.289438+00:00",
  "identifiers": {}
}