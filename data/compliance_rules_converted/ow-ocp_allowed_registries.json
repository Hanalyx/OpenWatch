{
  "_id": "ow-ocp_allowed_registries",
  "rule_id": "ow-ocp_allowed_registries",
  "scap_rule_id": "xccdf_org.ssgproject.content_rule_ocp_allowed_registries",
  "parent_rule_id": null,
  "metadata": {
    "name": "Allowed registries are configured",
    "description": "The configuration <tt>registrySources.allowedRegistries</tt> determines the\npermitted registries that the OpenShift container runtime can access for builds\nand pods. This configuration setting ensures that all registries other than\nthose specified are blocked.\n\nYou can set the allowed repositories by applying the following manifest using\n<pre>oc patch</pre>, e.g. if you save the following snippet to\n<pre>/tmp/allowed-registries-patch.yaml</pre>\n<pre>\nspec:\n  registrySources:\n    allowedRegistries:\n    - my-trusted-registry.internal.example.com\n</pre> you would call\n<pre>oc patch image.config.openshift.io cluster --patch=\"$(cat /tmp/allowed-registries-patch.yaml)\" --type=merge</pre>",
    "rationale": "Allowed registries should be configured to restrict the registries that the\nOpenShift container runtime can access, and all other registries should be\nblocked.",
    "source": {
      "upstream_id": "ocp_allowed_registries",
      "complianceascode_version": "0.1.73",
      "source_file": "converted_from_yaml",
      "cce_id": "",
      "imported_at": "2025-10-03T02:25:59.183740+00:00"
    }
  },
  "abstract": false,
  "severity": "medium",
  "category": "system_hardening",
  "security_function": "access_control",
  "tags": [
    "converted",
    "scap",
    "ssg",
    "severity_medium"
  ],
  "frameworks": {
    "cis": {
      "controls_v8": [
        "5.5.1"
      ]
    },
    "nist": {
      "800-53r5": [
        "CM-5(3)",
        "CM-7(2)",
        "CM-7(5)",
        "CM-11"
      ]
    },
    "stig": {
      "current": [
        "SRG-APP-000456-CTR-001125"
      ]
    }
  },
  "platform_implementations": {
    "rhel": {
      "versions": [
        "8",
        "9"
      ],
      "check_method": "custom",
      "check_command": "# TODO: Implement yamlfile_value check",
      "enable_command": "# TODO: Implement yamlfile_value remediation",
      "service_dependencies": []
    }
  },
  "platform_requirements": {
    "required_capabilities": [],
    "excluded_environments": []
  },
  "check_type": "template",
  "check_content": {
    "scap_rule_id": "xccdf_org.ssgproject.content_rule_ocp_allowed_registries",
    "method": "xccdf_evaluation",
    "expected_result": "pass"
  },
  "fix_available": true,
  "fix_content": {},
  "manual_remediation": "The configuration <tt>registrySources.allowedRegistries</tt> determines the\npermitted registries that the OpenShift container runtime can access for builds\nand pods. This configuration setting ensures that all registries other than\nthose specified are blocked.\n\nYou can set the allowed repositories by applying the following manifest using\n<pre>oc patch</pre>, e.g. if you save the following snippet to\n<pre>/tmp/allowed-registries-patch.yaml</pre>\n<pre>\nspec:\n  registrySources:\n    allowedRegistries:\n    - my-trusted-registry.internal.example.com\n</pre> you would call\n<pre>oc patch image.config.openshift.io cluster --patch=\"$(cat /tmp/allowed-registries-patch.yaml)\" --type=merge</pre>",
  "remediation_complexity": "medium",
  "remediation_risk": "low",
  "dependencies": {
    "requires": [],
    "conflicts": [],
    "related": []
  },
  "source_file": "applications/openshift/registry/ocp_allowed_registries/rule.yml",
  "source_hash": "sha256:569750896a1959a0",
  "version": "2024.2",
  "imported_at": "2025-10-03T02:25:59.183893+00:00",
  "updated_at": "2025-10-03T02:25:59.183897+00:00",
  "identifiers": {}
}