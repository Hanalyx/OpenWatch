{
  "_id": "ow-ocp_insecure_allowed_registries_for_import",
  "rule_id": "ow-ocp_insecure_allowed_registries_for_import",
  "scap_rule_id": "xccdf_org.ssgproject.content_rule_ocp_insecure_allowed_registries_for_import",
  "parent_rule_id": null,
  "metadata": {
    "name": "Check configured allowed registries for import uses secure protocol",
    "description": "The configuration <tt>allowedRegistriesForImport</tt> limits the container\nimage registries from which normal users may import images. This is a list\nof the registries that can be trusted to contain valid images and the image\nlocation configured is assumed to be secured unless configured otherwise. It\nis important to allow only secure registries to avoid man in the middle attacks,\nas the insecure image import request can be impersonated and could lead to\nfetching malicious content.\nList all the allowed repositories for import configured with insecure set to true\nusing the following command:\n<pre>oc get image.config.openshift.io/cluster -o json | jq '.spec | (.allowedRegistriesForImport[])? | select(.insecure==true)'</pre>\nRemove or edit the listed registries having insecure set by using the command:\n<pre>oc edit image.config.openshift.io/cluster</pre>\n\nFor more information, follow\n{{{ weblink(link=\"https://docs.openshift.com/container-platform/latest/openshift_images/image-configuration.html\",\n            text=\"the relevant documentation\") }}}.",
    "rationale": "Configured list of allowed registries for import should be from the secure source.",
    "source": {
      "upstream_id": "ocp_insecure_allowed_registries_for_import",
      "complianceascode_version": "0.1.73",
      "source_file": "converted_from_yaml",
      "cce_id": "CCE-86235-9",
      "imported_at": "2025-10-03T02:25:59.176624+00:00"
    }
  },
  "abstract": false,
  "severity": "medium",
  "category": "system_hardening",
  "security_function": "access_control",
  "tags": [
    "converted",
    "scap",
    "ssg",
    "severity_medium"
  ],
  "frameworks": {
    "cis": {
      "controls_v8": [
        "5.5.1"
      ]
    },
    "nist": {
      "800-53r5": [
        "CM-5(3)"
      ]
    },
    "stig": {
      "current": [
        "SRG-APP-000014-CTR-000035"
      ]
    }
  },
  "platform_implementations": {
    "rhel": {
      "versions": [
        "8",
        "9"
      ],
      "check_method": "custom",
      "check_command": "# TODO: Implement yamlfile_value check",
      "enable_command": "# TODO: Implement yamlfile_value remediation",
      "service_dependencies": []
    }
  },
  "platform_requirements": {
    "required_capabilities": [],
    "excluded_environments": []
  },
  "check_type": "template",
  "check_content": {
    "scap_rule_id": "xccdf_org.ssgproject.content_rule_ocp_insecure_allowed_registries_for_import",
    "method": "xccdf_evaluation",
    "expected_result": "pass"
  },
  "fix_available": true,
  "fix_content": {},
  "manual_remediation": "The configuration <tt>allowedRegistriesForImport</tt> limits the container\nimage registries from which normal users may import images. This is a list\nof the registries that can be trusted to contain valid images and the image\nlocation configured is assumed to be secured unless configured otherwise. It\nis important to allow only secure registries to avoid man in the middle attacks,\nas the insecure image import request can be impersonated and could lead to\nfetching malicious content.\nList all the allowed repositories for import configured with insecure set to true\nusing the following command:\n<pre>oc get image.config.openshift.io/cluster -o json | jq '.spec | (.allowedRegistriesForImport[])? | select(.insecure==true)'</pre>\nRemove or edit the listed registries having insecure set by using the command:\n<pre>oc edit image.config.openshift.io/cluster</pre>\n\nFor more information, follow\n{{{ weblink(link=\"https://docs.openshift.com/container-platform/latest/openshift_images/image-configuration.html\",\n            text=\"the relevant documentation\") }}}.",
  "remediation_complexity": "medium",
  "remediation_risk": "low",
  "dependencies": {
    "requires": [],
    "conflicts": [],
    "related": []
  },
  "source_file": "applications/openshift/registry/ocp_insecure_allowed_registries_for_import/rule.yml",
  "source_hash": "sha256:92d6e4e966a1b4ad",
  "version": "2024.2",
  "imported_at": "2025-10-03T02:25:59.176750+00:00",
  "updated_at": "2025-10-03T02:25:59.176753+00:00",
  "identifiers": {
    "cce": "CCE-86235-9"
  }
}