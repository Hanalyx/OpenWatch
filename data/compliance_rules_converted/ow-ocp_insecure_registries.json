{
  "_id": "ow-ocp_insecure_registries",
  "rule_id": "ow-ocp_insecure_registries",
  "scap_rule_id": "xccdf_org.ssgproject.content_rule_ocp_insecure_registries",
  "parent_rule_id": null,
  "metadata": {
    "name": "Check if any insecure registry sources is configured",
    "description": "The configuration <tt>registrySources.insecureRegistries</tt> determines the\ninsecure registries that the OpenShift container runtime can access for builds\nand pods. This configuration setting is for accessing the configured registries\nwithout TLS validation which could lead to security breaches and should be\navoided.\nRemove any insecureRegistries configured using the following command:\n<pre>oc patch image.config.openshift.io cluster --type=json -p \"[{'op': 'remove', 'path': '/spec/registrySources/insecureRegistries'}]\"</pre>\n\nFor more information, follow\n{{{ weblink(link=\"https://docs.openshift.com/container-platform/latest/openshift_images/image-configuration.html\",\n            text=\"the relevant documentation\") }}}.",
    "rationale": "Insecure registries should not be configured, which would restrict the possibilities of\nOpenShift container runtime accessing registries which cannot be validated.",
    "source": {
      "upstream_id": "ocp_insecure_registries",
      "complianceascode_version": "0.1.73",
      "source_file": "converted_from_yaml",
      "cce_id": "CCE-86123-7",
      "imported_at": "2025-10-03T02:25:59.180828+00:00"
    }
  },
  "abstract": false,
  "severity": "medium",
  "category": "system_hardening",
  "security_function": "access_control",
  "tags": [
    "converted",
    "scap",
    "ssg",
    "severity_medium"
  ],
  "frameworks": {
    "cis": {
      "controls_v8": [
        "5.5.1"
      ]
    },
    "nist": {
      "800-53r5": [
        "CM-5(3)"
      ]
    },
    "stig": {
      "current": [
        "SRG-APP-000014-CTR-000035"
      ]
    }
  },
  "platform_implementations": {
    "rhel": {
      "versions": [
        "8",
        "9"
      ],
      "check_method": "custom",
      "check_command": "# TODO: Implement yamlfile_value check",
      "enable_command": "# TODO: Implement yamlfile_value remediation",
      "service_dependencies": []
    }
  },
  "platform_requirements": {
    "required_capabilities": [],
    "excluded_environments": []
  },
  "check_type": "template",
  "check_content": {
    "scap_rule_id": "xccdf_org.ssgproject.content_rule_ocp_insecure_registries",
    "method": "xccdf_evaluation",
    "expected_result": "pass"
  },
  "fix_available": true,
  "fix_content": {},
  "manual_remediation": "The configuration <tt>registrySources.insecureRegistries</tt> determines the\ninsecure registries that the OpenShift container runtime can access for builds\nand pods. This configuration setting is for accessing the configured registries\nwithout TLS validation which could lead to security breaches and should be\navoided.\nRemove any insecureRegistries configured using the following command:\n<pre>oc patch image.config.openshift.io cluster --type=json -p \"[{'op': 'remove', 'path': '/spec/registrySources/insecureRegistries'}]\"</pre>\n\nFor more information, follow\n{{{ weblink(link=\"https://docs.openshift.com/container-platform/latest/openshift_images/image-configuration.html\",\n            text=\"the relevant documentation\") }}}.",
  "remediation_complexity": "medium",
  "remediation_risk": "low",
  "dependencies": {
    "requires": [],
    "conflicts": [],
    "related": []
  },
  "source_file": "applications/openshift/registry/ocp_insecure_registries/rule.yml",
  "source_hash": "sha256:296e689175320dfe",
  "version": "2024.2",
  "imported_at": "2025-10-03T02:25:59.180959+00:00",
  "updated_at": "2025-10-03T02:25:59.180962+00:00",
  "identifiers": {
    "cce": "CCE-86123-7"
  }
}