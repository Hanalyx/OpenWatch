{
  "_id": "ow-example-ssh-disable-root-login",
  "rule_id": "ow-example-ssh-disable-root-login",
  "scap_rule_id": "xccdf_org.ssgproject.content_rule_sshd_disable_root_login",
  "parent_rule_id": null,
  
  "metadata": {
    "name": "Disable SSH Root Login",
    "description": "Configure SSH daemon to prevent direct root login attempts by setting PermitRootLogin to 'no' in sshd_config.",
    "rationale": "Disabling direct root login via SSH reduces attack surface by preventing brute force attacks against the root account. Administrative access should use sudo or su instead.",
    "source": {
      "upstream_id": "sshd_disable_root_login", 
      "complianceascode_version": "0.1.73",
      "source_file": "ssg-rhel8-ds.xml",
      "cce_id": "CCE-27445-6",
      "imported_at": "2025-09-14T12:30:00.000Z"
    },
    "warnings": [
      "This rule disables direct root SSH access. Ensure alternative administrative access methods are configured before applying.",
      "Emergency access procedures should be established in case of authentication system failures."
    ]
  },

  "identifiers": {
    "cce": "CCE-27445-6",
    "cve_references": [],
    "nist_id": "AC-2",
    "openwatch_id": "ow-example-ssh-disable-root-login"
  },

  "abstract": false,
  "severity": "high",
  "category": "authentication", 
  "security_function": "access_control",
  "tags": [
    "ssh",
    "authentication", 
    "root_access",
    "remote_access",
    "scap",
    "rhel8",
    "ssg",
    "trusted"
  ],

  "compliance_mappings": {
    "frameworks": [
      {
        "framework": "cis_controls_v8",
        "framework_version": "8.0",
        "controls": ["5.2", "5.3"]
      },
      {
        "framework": "nist_800_53r5",
        "framework_version": "revision_5",
        "controls": ["AC-2", "AC-3", "IA-2"]
      },
      {
        "framework": "pci_dss_4.0", 
        "framework_version": "4.0",
        "controls": ["8.2.3", "8.3.6"]
      },
      {
        "framework": "iso_27001_2013",
        "framework_version": "2013",
        "controls": ["A.9.2.3"]
      }
    ],
    "benchmarks": [
      {
        "benchmark": "cis_rhel8_v2.0.0",
        "benchmark_version": "2.0.0",
        "controls": ["5.2.8"],
        "source_framework": "cis_controls_v8",
        "satisfies_frameworks": ["cis_controls_v8", "nist_800_53r5", "pci_dss_4.0", "iso_27001_2013"]
      },
      {
        "benchmark": "stig_rhel8_v1r11",
        "benchmark_version": "1.11",
        "controls": ["RHEL-08-010550"],
        "source_framework": "disa_stig",
        "satisfies_frameworks": ["nist_800_53r5"]
      }
    ]
  },

  "platform_implementations": {
    "rhel": {
      "versions": ["8.0", "8.1", "8.2", "8.3", "8.4", "8.5", "8.6", "8.7", "8.8", "8.9", "8.10"],
      "service_name": "sshd",
      "config_files": ["/etc/ssh/sshd_config"],
      "check_method": "file",
      "check_command": "grep '^PermitRootLogin no' /etc/ssh/sshd_config",
      "validation_command": "systemctl reload sshd && sshd -t",
      "service_dependencies": ["openssh-server"]
    },
    "ubuntu": {
      "versions": ["20.04", "22.04", "24.04"],
      "service_name": "ssh",
      "config_files": ["/etc/ssh/sshd_config"],
      "check_method": "file", 
      "check_command": "grep '^PermitRootLogin no' /etc/ssh/sshd_config",
      "validation_command": "systemctl reload ssh && sshd -t",
      "service_dependencies": ["openssh-server"]
    }
  },

  "platform_requirements": {
    "required_capabilities": ["ssh_server", "systemd_service_management"],
    "excluded_environments": ["container", "chroot"],
    "minimum_privileges": "root"
  },

  "check_type": "scap",
  "check_content": {
    "scap_rule_id": "xccdf_org.ssgproject.content_rule_sshd_disable_root_login",
    "method": "xccdf_evaluation",
    "oval_reference": {
      "href": "ssg-rhel8-oval.xml",
      "definition": "oval:ssg-sshd_disable_root_login:def:1"
    },
    "expected_result": "pass",
    "check_parameters": {
      "config_file": "/etc/ssh/sshd_config",
      "parameter_name": "PermitRootLogin", 
      "expected_value": "no",
      "match_type": "exact"
    }
  },

  "fix_available": true,
  "fix_content": {
    "shell": {
      "complexity": "low",
      "disruption": "low", 
      "reboot_required": false,
      "strategy": "restrict",
      "script": "#!/bin/bash\n# Disable SSH root login\nset -euo pipefail\n\n# Backup original config\ncp /etc/ssh/sshd_config /etc/ssh/sshd_config.backup.$(date +%Y%m%d_%H%M%S)\n\n# Update PermitRootLogin setting\nif grep -q '^PermitRootLogin' /etc/ssh/sshd_config; then\n    sed -i 's/^PermitRootLogin.*/PermitRootLogin no/' /etc/ssh/sshd_config\nelse\n    echo 'PermitRootLogin no' >> /etc/ssh/sshd_config\nfi\n\n# Validate configuration and reload\nif sshd -t; then\n    systemctl reload sshd\n    echo 'SSH root login disabled successfully'\nelse\n    echo 'SSH configuration error - restoring backup'\n    cp /etc/ssh/sshd_config.backup.$(date +%Y%m%d_%H%M%S) /etc/ssh/sshd_config\n    exit 1\nfi"
    },
    "ansible": {
      "complexity": "low",
      "disruption": "low",
      "playbook": "- name: Disable SSH Root Login\n  lineinfile:\n    path: /etc/ssh/sshd_config\n    regexp: '^#?PermitRootLogin'\n    line: 'PermitRootLogin no'\n    backup: yes\n    validate: '/usr/sbin/sshd -t -f %s'\n  notify:\n    - reload sshd\n\n- name: reload sshd\n  systemd:\n    name: sshd\n    state: reloaded"
    }
  },

  "fix_extension": true,
  "fix_extension_config": {
    "plugin_name": "@openwatch/aegis-remediation",
    "plugin_version": "^1.0.0",
    "api_endpoint": "/api/v1/remediation/execute",
    "authentication_method": "service_account",
    "timeout_seconds": 300,
    "retry_policy": {
      "max_attempts": 3,
      "backoff_strategy": "exponential"
    },
    "remediation_parameters": {
      "rule_id": "ow-example-ssh-disable-root-login",
      "target_platform": "auto_detect",
      "validation_required": true,
      "rollback_on_failure": true
    },
    "supported_platforms": ["rhel", "ubuntu", "centos"],
    "requires_approval": false,
    "auto_remediation_enabled": true
  },

  "manual_remediation": "To manually disable SSH root login:\n1. Edit /etc/ssh/sshd_config\n2. Set 'PermitRootLogin no'\n3. Validate config with 'sshd -t'\n4. Reload SSH service: 'systemctl reload sshd'",
  
  "remediation_complexity": "low",
  "remediation_risk": "medium",

  "dependencies": {
    "requires": ["openssh-server"],
    "conflicts": ["emergency_access_mode"],
    "related": ["ow-ssh-key-based-auth", "ow-sudo-configuration"]
  },

  "source_file": "ssg-rhel8-ds.xml",
  "source_hash": "sha256:1234567890abcdef", 
  "version": "2024.2",
  "imported_at": "2025-09-14T12:30:00.000Z",
  "updated_at": "2025-09-14T12:30:00.000Z"
}